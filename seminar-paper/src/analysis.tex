% analysis.tex

\chapter{Analysis}
\thispagestyle{chapterstart}

\section{Methodology}

In this chapter, we evaluate the side-channel resistance and performance of various masked implementations of the CRYSTALS-Dilithium digital signature scheme. Our methodology focuses on comparing key metrics across selected implementations to understand the trade-offs between security and efficiency, particularly in the context of embedded devices.

The main aspects considered are:

\begin{itemize}
    \item \textbf{Security Level}: The order of masking applied and robustness against side-channel attacks.
    \item \textbf{Performance Metrics}: Execution time, cycle counts, and computational overhead introduced by the masking techniques.
    \item \textbf{Feasibility on Embedded Devices}: Practicality of implementations on resource-constrained platforms.
    \item \textbf{Implementation Techniques}: Specific masking schemes and optimizations employed to enhance security and performance.
    \item \textbf{Trade-offs}: Balancing security requirements with performance constraints.
\end{itemize}

We base our analysis on key papers that have significantly contributed to side-channel resistant implementations of Dilithium.

\section{Selected Implementations}

\subsection{Masking Dilithium: Efficient Implementation and Side-Channel Evaluation}

Migliore et al.\ \cite{Migliore19} introduce a first-order masked implementation of Dilithium, focusing on efficient techniques suitable for embedded devices. They address the challenges of masking lattice-based operations and aim to minimize the performance overhead associated with side-channel countermeasures. The authors propose using a power-of-two modulus to simplify masking and improve efficiency without affecting security.

\subsubsection{Security Level}

The implementation targets first-order side-channel resistance by applying masking to sensitive variables. The authors identify the parts of the algorithm requiring protection, such as secret keys and intermediate computations involving these keys.

\subsubsection{Performance Metrics}

Key performance metrics reported include:

\begin{itemize}
    \item \textbf{Execution Time}: The masked implementation introduces an overhead of approximately $5.6\times$ compared to the unmasked version.
    \item \textbf{Cycle Counts}: Optimizations, including the use of a power-of-two modulus, reduce cycle counts for critical operations, improving performance.
\end{itemize}

\subsubsection{Feasibility on Embedded Devices}

The authors demonstrate that their first-order masked implementation is practical on embedded platforms. By using a power-of-two modulus, they achieve acceptable performance suitable for resource-constrained devices.

\subsubsection{Implementation Techniques}

They employ specialized algorithms for masking polynomial arithmetic and optimize the implementation by minimizing non-linear operations that require costly masking. The key innovation is the use of a power-of-two modulus, simplifying the masking of decomposition functions and reducing complexity.

\subsection{Protecting Dilithium Against Leakage Revisited}

Azouaoui et al.\ \cite{Azouaoui22} revisit the masking of Dilithium by performing a refined sensitivity analysis and introducing improved masking gadgets tailored to Dilithium. They identify flaws in previous analyses, such as that of Migliore et al., and propose corrections leading to more secure and efficient implementations.

\subsubsection{Security Level}

Their implementations support higher-order masking, providing security against side-channel attacks up to the eighth masking order ($d=8$). By accurately classifying the sensitivity of intermediate computations, they ensure that only necessary components are masked, avoiding insecurity due to unprotected variables and inefficiency from unnecessary masking.

\subsubsection{Performance Metrics}

Performance improvements are achieved through:

\begin{itemize}
    \item \textbf{Optimized Masking Gadgets}: Introduction of new gadgets specifically designed for Dilithium operations, leveraging advances in masking conversion algorithms.
    \item \textbf{Randomized vs.\ Deterministic Signing}: Demonstrating that randomized signing can lead to significantly more efficient implementations when side-channel attacks are a concern.
\end{itemize}

For first-order masking ($d=2$), their randomized implementation requires approximately 13.9 million cycles on an ARM Cortex-M4 microcontroller, significantly faster than the deterministic version.

\subsubsection{Feasibility on Embedded Devices}

The implementations are practical on embedded devices for various masking orders. The authors provide benchmarks on an ARM Cortex-M4, showing acceptable performance even at higher masking orders due to their optimized gadgets.

\subsubsection{Implementation Techniques}

Key strategies include:

\begin{itemize}
    \item \textbf{Refined Sensitivity Analysis}: Re-examining the sensitivity of variables and operations, correcting previous misconceptions, and ensuring proper protection of sensitive variables.
    \item \textbf{Improved Masking Gadgets}: Developing new gadgets dedicated to Dilithium's operations, such as bound checks and the decomposition function.
    \item \textbf{PINI-Compliant Gadgets}: Utilizing Probe-Isolating Non-Interference (PINI) compliant gadgets to ensure security and enable secure composition of masked operations.
    \item \textbf{Randomized Signing}: Exploiting randomized signing over deterministic signing to achieve better performance and security against side-channel attacks.
\end{itemize}

\subsection{Improved Gadgets for the High-Order Masking of Dilithium}

Coron et al.\ \cite{Coron23} propose new masking gadgets to enhance the efficiency of high-order masking in Dilithium. They focus on reducing the complexity of critical operations and provide security proofs in the probing model.

\subsubsection{Security Level}

The gadgets are designed to be secure against high-order side-channel attacks, with proofs ensuring robustness in the $t$-probing model.

\subsubsection{Performance Metrics}

Significant performance improvements are reported for small masking orders:

\begin{itemize}
    \item \textbf{ShiftMod Gadget}: Reduces complexity of arithmetic shifts, improving efficiency.
    \item \textbf{Boolean-to-Arithmetic Conversion}: Achieves lower operation counts for small $d$.
\end{itemize}

However, complexity increases exponentially with the masking order $d$, limiting practicality for higher orders.

\subsubsection{Feasibility on Embedded Devices}

For small masking orders, the implementations are feasible on embedded devices. The exponential complexity makes higher-order masking less practical on resource-constrained platforms.

\subsubsection{Implementation Techniques}

Innovations include:

\begin{itemize}
    \item \textbf{ShiftMod Gadget}: Efficient arithmetic shifts modulo $2q$.
    \item \textbf{Optimized Masking of Decompose Function}: Methods providing efficiency gains for critical operations.
\end{itemize}